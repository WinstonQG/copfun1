!function(e){"use strict";AWEContent.Models.HeaderItem=AWEContent.Models.Item.extend({defaults:{machine_name:"header",tagName:"h2",textContent:"Type your header here",fontFamily:"",fontStyle:"",textAlign:"left",fontSize:-1,lineHeight:-1,letterSpacing:-1,color:"",backgroundColor:"",boxModelSettings:{},customID:"",customClass:"",customEnableAttributes:0,customDataAttributes:"[] ",customActionAttributes:'{"newAction": "", "newAttrName": "", "newAttrValue": ""}',customEnableAnimations:0,customDataAnimations:'{"type" : "none"}',lgResponsive:!0,xsResponsive:!0,mediumResponsive:!0,smResponsive:!0},relations:[{type:Backbone.HasOne,key:"boxModelSettings",relatedModel:AWEContent.Models.BoxModelSettings}],createView:function(){this.view=new AWEContent.Views.HeaderItem({model:this})},clone:function(){var t={};return e.each(this.toJSON(),function(e,n){t[e]=n}),t.boxModelSettings=new AWEContent.Models.BoxModelSettings(t.boxModelSettings),new AWEContent.Models.HeaderItem(t)}}),AWEContent.Views.HeaderItem=AWEContent.Views.Item.extend({additionalEvents:{},initialize:function(){AWEContent.Views.Item.prototype.initialize.call(this),this.listenTo(this.model.get("boxModelSettings"),"change",this.applySettingsChanged)},renderItemContent:function(){var t=this,n=e("<"+this.model.get("tagName")+"/>"),a=this.model.toJSON(),i={"font-family":a.fontFamily,"text-align":a.textAlign,"font-size":-1==a.fontSize?"":a.fontSize+"px","line-height":-1==a.lineHeight?"":a.lineHeight+"px","letter-spacing":-1==a.letterSpacing?"":a.letterSpacing+"px",color:a.color,"background-color":a.backgroundColor};if(a.fontStyle&&(i=e.extend({},i,JSON.parse(a.fontStyle))),n.html(a.textContent).addClass("awe-item awe-header").css(i).attr("id",a.customID).addClass(a.customClass).renderItemDefaultBoxModel(a.boxModelSettings),n.renderItemDefaultAttributes(a.customEnableAttributes,a.customDataAttributes),a.customEnableAnimations){var o=a.customDataAnimations;n.processAnimations(o)}return t.iframeJQuery(this.el).delegate(t.model.get("tagName"),"itemReady",function(){var n,a;t.iframeJQuery(this).hallo({plugins:{halloformat:{formattings:{bold:!0,italic:!0,strikethrough:!0,underline:!0}}},create:function(){this.addEventListener("paste",function(e){e.preventDefault();var t=e.clipboardData.getData("text/plain");AWEContent.documentIframe.execCommand("insertHTML",!1,t)})},editable:!0,activated:function(t){n=e(t.target).height()},deactivated:function(i){t.changeContent(i),a=e(i.target).height(),a!=n&&t.resizeItem()}})}),t.$el.defaultResponsive(a),n},applySettingsChanged:function(t){var n=this,a=e(n.model.get("tagName"),n.$el),i=t.toJSON(),o=n.$el.height();e.each(t.changedAttributes(),function(o,s){switch(n.$el.changeResponsive(o,s),a.renderChangeSettingBoxModel(o,s,t),o){case"fontFamily":a.css("font-family",s);break;case"fontStyle":console.log(s);var l=s?JSON.parse(s):{"font-weight":"","font-style":""};a.css(l);break;case"textAlign":a.css("text-align",s);break;case"fontSize":-1==s?a.css("font-size",""):a.css("font-size",s+"px");break;case"lineHeight":-1==s?a.css("line-height",""):a.css("line-height",s+"px");break;case"letterSpacing":-1==s?a.css("letter-spacing",""):a.css("letter-spacing",s+"px");break;case"tagName":var r=n.model.previousAttributes().tagName,c=n.iframeJQuery(n.$el);e(r,n.$el).remove(),n.$el.append(n.renderItemContent()),n.iframeJQuery(s,c).hallo({plugins:{halloformat:{formattings:{bold:!0,italic:!0,strikethrough:!0,underline:!0}}},editable:!0,create:function(){this.addEventListener("paste",function(e){e.preventDefault();var t=e.clipboardData.getData("text/plain");AWEContent.documentIframe.execCommand("insertHTML",!1,t)})},deactivated:function(e){n.changeContent(e)}});break;case"color":a.css("color",s);break;case"backgroundColor":a.css("background-color",s);break;case"customID":a.attr("id",s);break;case"customClass":var d=n.model.previousAttributes().customClass;a.removeClass(d).addClass(s);break;case"customEnableAttributes":a.renderChangeSettingsAttributes(o,s,i.customDataAttributes);break;case"customActionAttributes":a.renderChangeSettingsAttributes(o,s);break;case"customEnableAnimations":var u,m;s?(u=i.customDataAnimations,m=null,a.processAnimations(u)):(u=null,m=i.customDataAnimations,a.processAnimations(u,m));break;case"customDataAnimations":var u,m;u=i.customDataAnimations,m=n.model.previousAttributes().customDataAnimations,a.processAnimations(u,m)}}),setTimeout(function(){n.checkChangeHeight(o)},50)},processAnimations:function(){function t(e,t){var n="";switch(e){case"floatin":n="proty-dir-"+t;break;case"flyin":n="proty-dir-distant-"+t;break;case"turnin":n="proty-dir-turn-"+t}return n}function n(e){var t="";return"none"!=e&&(t="ant-"+e),t}function a(a,i){var o,s,l="",r="";return a&&""!=a?(a=e.parseJSON(a),o=a.type,s=a.advance,l=n(o),r=t(o,s),i.removeClass(l+" "+r).css({"animation-duration":"","animation-delay":""}),"spinin"==o&&u.css({"-ms-transform":"","-webkit-transform":"",transform:""}),!0):!1}function i(){if(""!=m){if(m=e.parseJSON(m),o=m.type,s=m.duration,l=m.delay,r=m.advance,h=n(o),p=t(o,r),u.css({"animation-duration":s+"ms","animation-delay":l+"ms"}),"spinin"==o){var a=360*parseInt(r.numberOfSpin);a="clockwise"==r.direction?-a:a,a="rotate("+a+"deg)",u.css({"-ms-transform":a,"-webkit-transform":a,transform:a})}u.addClass(h+" "+p)}}var o,s,l,r,c=this,d=c.model.toJSON(),u=e(c.model.get("tagName"),c.$el),m=(d.customEnableAnimations,d.customDataAnimations),g=c.model.previousAttributes().customDataAnimations,h="",p="";a(g,u),setTimeout(function(){i()},50)},changeContent:function(t){var n=e(t.currentTarget).html();this.model.set("textContent",n)}}),AWEContent.Views.HeaderItemController=AWEContent.Views.ItemController.extend({machineName:"header",controllerHtml:function(){return'<div class="title-icon">Header</div><i class="ic ac-icon-header"></i>'},createItemModel:function(e){var t;return void 0!=e?(t=new AWEContent.Models.BoxModelSettings(e.boxModelSettings),e.boxModelSettings=t,new AWEContent.Models.HeaderItem(e)):new AWEContent.Models.HeaderItem({boxModelSettings:new AWEContent.Models.BoxModelSettings})}}),AWEContent.Views.HeaderPanel=AWEContent.Views.ItemPanel.extend({tagName:"div",className:"awe-obj-panel header-panel",panelName:"header",initPanel:function(){AWEContent.Views.ItemPanel.prototype.initPanel.call(this);var t=this;e("#header-font",this.$el).bind("fontFamilyChange",function(e,n){t.editingModel.set("fontFamily",n)}).bind("fontStyleChange",function(e,n){t.editingModel.set("fontStyle",n.value)}).bind("textAlignChange",function(e,n){t.editingModel.set("textAlign",n.value)}).bind("fontSizeChange",function(e,n){t.editingModel.set("fontSize",n.value)}).bind("letterSpacingChange",function(e,n){t.editingModel.set("letterSpacing",n.value)}).bind("lineHeightChange",function(e,n){t.editingModel.set("lineHeight",n.value)}),e("#header-tag",this.el).change(function(e,n){t.editingModel.set("tagName",n.value.toLowerCase())}),e("#header-text-color",this.el).change(function(e,n){n=n?n.toRgbString():"",t.editingModel.set("color",n)}),e("#header-background-color",this.el).change(function(e,n){n=n?n.toRgbString():"",t.editingModel.set("backgroundColor",n)}),e("#header-layout-tab",this.el).initBoxModelPanel(this,"boxModelSettings"),e("#text-header-custom-id",this.el).change(function(){t.editingModel.set("customID",e(this).val())}),e("#text-header-custom-classes",this.el).change(function(){t.editingModel.set("customClass",e(this).val())}),e("#header-custom-attributes",this.el).initAttributesPanel(t),e("#header-animations input[name=enabled_custom_animation]",this.el).change(function(n,a){t.editingModel.set("customEnableAnimations",parseInt(e(this).val())),a&&t.editingModel.set("customDataAnimations",JSON.stringify(a.animations))})},setPanelElementsValue:function(){var t=this.editingModel.toJSON();console.log(t.fontFamily),e("#header-font",this.$el).aweFont("options",{fontFamily:t.fontFamily,fontStyle:t.fontStyle,fontSize:t.fontSize,textAlign:t.textAlign,lineHeight:t.lineHeight,letterSpacing:t.letterSpacing}),e("#header-tag",this.$el).aweSlider("value",t.tagName.toUpperCase()),e("#header-text-color",this.el).aweColorPicker("value",t.color),e("#header-background-color",this.el).aweColorPicker("value",t.backgroundColor),e("#header-layout-tab",this.el).initBoxModel(t.boxModelSettings),e("#text-header-custom-id",this.el).val(t.customID),e("#text-header-custom-classes",this.el).val(t.customClass),e("#header-custom-attributes",this.el).initAttributes(t.customEnableAttributes,t.customDataAttributes),e("#header-animations input[name=enabled_custom_animation]",this.el).val(t.customEnableAnimations).trigger("change"),e("#header-animations input[name=enabled_custom_animation]",this.el).attr("data-animations",t.customDataAnimations).data("view",this.editingModel.view)},buildPanel:function(){return{title:{type:"markup",markup:'<div class="awe-title"><h2>Header</h2></div>'},font_settings:{type:"section",font:{type:"font"}},header_tag:{type:"section",tag:{type:"slider",title:"Heading tag",values:["H1","H2","H3","H4","H5","H6"],default_value:"H2",allow_type:!1}},color_settings:{type:"section",text_color:{type:"colorpicker",title:"Color",options:{preferredFormat:"rgb",AlphaVerticle:!0,showAlpha:!0,allowEmpty:!0,showInput:!0}},background_color:{type:"colorpicker",title:"Background Color",options:{preferredFormat:"rgb",AlphaVerticle:!0,showAlpha:!0,allowEmpty:!0,showInput:!0}}},box_settings:{type:"section",layout_tab:{type:"tabs",tabs:[{tab_title:"Border",contents:{header_border:{type:"box_border",min_value:0,max_value:100,default_value:0}}},{tab_title:"Radius",contents:{header_boder_radius:{type:"box_model",model_type:"border_radius",min_value:0,max_value:100,allow_type:!0}}},{tab_title:"Padding",contents:{header_padding:{type:"box_model",model_type:"padding",allow_type:!0,min_value:0,max_value:100}}},{tab_title:"Margin",contents:{header_margin:{type:"box_model",model_type:"margin",allow_type:!0,min_value:0,max_value:100}}}]}},others:{type:"section",custom_id:{type:"text_field",title:"ID",default_value:"ID"},custom_classes:{type:"text_field",title:"Classes",default_value:"className"},custom_attributes:{type:"custom_attributes"},animations:{type:"animations"}}}}}),e(document).ready(function(){AWEContent.Controllers.header=new AWEContent.Views.HeaderItemController,AWEContent.Panels.header=new AWEContent.Views.HeaderPanel})}(jQuery);