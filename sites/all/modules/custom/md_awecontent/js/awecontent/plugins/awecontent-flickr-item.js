!function(e){"use strict";AWEContent.Models.Flick=Backbone.Model.extend({}),AWEContent.Collections.Flicks=Backbone.Collection.extend({model:AWEContent.Models.Flick,stream:"group",id:"130337024@N06",url:function(){var e=this.stream,t=this.id,i="user"==e?"https://api.flickr.com/services/feeds/photos_public.gne":"https://api.flickr.com/services/feeds/groups_pool.gne";return i+"?id="+t+"&format=json&jsoncallback=?"},parse:function(e){return e.items}}),AWEContent.Views.FlicksView=Backbone.View.extend({initialize:function(){_.bindAll(this,"render");var e=this;this.collection.fetch({success:function(){e.render()}})},template:_.template('<li class="awe-item-flickr">                <a target="_blank" href="<%= href %>" data-group="example-set" title="Title: <%= title %>" class="<%= lightbox %>">                <img src="<%= src %>" alt="image-flickr"></a>            </li>'),render:function(){var t=this,i=t.collection.numberPhoto-1,l=t.collection.numberColum,n=t.collection.lightbox,a="";e.each(this.collection.toJSON(),function(e,i){var l=i.media.m.replace("_m.jpg",""),o=l+"_q.jpg",s=l+"_c.jpg",r=i.link,c="openlightbox"==n?s:r,u=i.title;a+=t.template({href:c,src:o,title:u,lightbox:n})}),e(".awe-flickr",this.el).html('<ul class="awe-flickr-list">'+a+"</ul>").addClass("type-column-"+l),e(".awe-flickr li:gt("+i+")",this.el).hide().find("a").removeClass("openlightbox"),e(".awe-item-preload",this.$el).remove()}}),AWEContent.Models.FlickrItem=AWEContent.Models.Item.extend({defaults:{machine_name:"flickr",tagName:"div",flickrID:"113963751@N02",numberPhoto:"12",numberColum:"4",imageMargin:3,flickrStream:"user",flickrPreview:"openlightbox",boxModelSettings:{},customID:"",customClass:"",customEnableAttributes:0,customDataAttributes:"[] ",customActionAttributes:'{"newAction": "", "newAttrName": "", "newAttrValue": ""}',customEnableAnimations:0,customDataAnimations:'{"type" : "none"}',lgResponsive:!0,xsResponsive:!0,mediumResponsive:!0,smResponsive:!0},relations:[{type:Backbone.HasOne,key:"boxModelSettings",relatedModel:AWEContent.Models.BoxModelSettings}],createView:function(){this.view=new AWEContent.Views.FlickrItem({model:this})},clone:function(){var t={};return e.each(this.toJSON(),function(e,i){t[e]=i}),t.boxModelSettings=new AWEContent.Models.BoxModelSettings(t.boxModelSettings),new AWEContent.Models.FlickrItem(t)}}),AWEContent.Views.FlickrItem=AWEContent.Views.Item.extend({initialize:function(){AWEContent.Views.Item.prototype.initialize.call(this);var e=this;this.listenTo(this.model.get("boxModelSettings"),"change",this.applySettingsChanged),AWEContent.Library.addLibrary("magnific",function(){e.openlightbox(e)})},renderItemContent:function(){var t=this,i=e('<div class="awe-item awe-flickr"><div class="awe-item-preload"></div></div>'),l=t.model.toJSON();if(t.renderFlick(l),i.attr("id",l.customID).addClass(l.customClass),i.renderItemDefaultAttributes(l.customEnableAttributes,l.customDataAttributes),i.renderItemDefaultBoxModel(l.boxModelSettings),l.customEnableAnimations){var n=l.customDataAnimations;i.processAnimations(n)}return t.$el.defaultResponsive(l),i},applySettingsChanged:function(t){var i=this,l=i.model.toJSON(),n=l.numberColum,a=l.numberPhoto-1,o=e(".awe-flickr",i.el),s=i.$el.height();e.each(t.changed,function(s,r){switch(i.$el.changeResponsive(s,r),o.renderChangeSettingBoxModel(s,r,t),s){case"flickrID":case"flickrStream":i.renderFlick(l);break;case"numberColum":var c="type-column-"+i.model.previousAttributes().numberColum;e(".awe-flickr ul",i.$el).removeClass().addClass("awe-flickr-list "+l.customClass),e(".awe-flickr",i.$el).removeClass(c).addClass("type-column-"+n);break;case"numberPhoto":e(".awe-flickr ul li:gt("+a+")",i.$el).hide().find("a").removeClass("openlightbox"),e(".awe-flickr ul li:lt("+(a+1)+")",i.$el).show().find("a").addClass("openlightbox");break;case"flickrPreview":i.renderFlick(l);break;case"imageMargin":-1==r?(e(".awe-item-flickr",i.$el).css({padding:""}),e(".awe-item ul",i.$el).css({margin:""})):(e(".awe-item-flickr",i.$el).css({padding:r+"px"}),e(".awe-item ul",i.$el).css({margin:"-"+r+"px"}));break;case"customID":o.attr("id",r);break;case"customClass":var u=i.model.previousAttributes().customClass;o.removeClass(u).addClass(r);break;case"customActionAttributes":o.renderChangeSettingsAttributes(s,r);break;case"customEnableAttributes":o.renderChangeSettingsAttributes(s,r,l.customDataAttributes);break;case"customEnableAnimations":var m,d;r?(m=l.customDataAnimations,d=null,o.processAnimations(m)):(m=null,d=l.customDataAnimations,o.processAnimations(m,d));break;case"customDataAnimations":var m,d;m=l.customDataAnimations,d=i.model.previousAttributes().customDataAnimations,o.processAnimations(m,d)}}),setTimeout(function(){i.checkChangeHeight(s)},50)},renderFlick:function(e){var t=new AWEContent.Collections.Flicks;return t.stream=e.flickrStream,t.id=e.flickrID,t.numberPhoto=e.numberPhoto,t.numberColum=e.numberColum,t.lightbox=e.flickrPreview,new AWEContent.Views.FlicksView({el:this.$el,collection:t})},openlightbox:function(){AWEContent.jqIframe(".awe-flickr, .awe-type-lightbox",this.el).magnificPopup({delegate:".openlightbox",type:"image",removalDelay:300,mainClass:"mfp-fade",prependTo:".awe-page-wrapper",gallery:{enabled:!0,preload:[0,2],navigateByImgClick:!0}})}}),AWEContent.Views.FlickrItemController=AWEContent.Views.ItemController.extend({machineName:"flickr",controllerHtml:function(){return'<div class="title-icon">Flickr</div><i class="ic ac-icon-flickr"></i>'},createItemModel:function(e){var t;return void 0!=e?(t=new AWEContent.Models.BoxModelSettings(e.boxModelSettings),e.boxModelSettings=t,new AWEContent.Models.FlickrItem(e)):new AWEContent.Models.FlickrItem({boxModelSettings:new AWEContent.Models.BoxModelSettings})}}),AWEContent.Views.FlickrPanel=AWEContent.Views.ItemPanel.extend({tagName:"div",className:"awe-obj-panel panel-flickr",panelName:"flickr",initPanel:function(){AWEContent.Views.ItemPanel.prototype.initPanel.call(this);var t=this;e("#flickr-enter-link input",t.$el).change(function(){t.editingModel.set("flickrID",e(this).val())}),e("#flickr-custom-id input",t.$el).change(function(){t.editingModel.set("customID",e(this).val())}),e("#flickr-custom-class input",t.$el).change(function(){t.editingModel.set("customClass",e(this).val())}),e("#flickr-stream",t.$el).change(function(e,i){t.editingModel.set("flickrStream",i.value)}),e("#flickr-number-photo",this.$el).change(function(e,i){t.editingModel.set("numberPhoto",i.value)}),e("#flickr-column",this.$el).change(function(e,i){t.editingModel.set("numberColum",i.value)}),e("#flickr-preview",t.$el).change(function(e,i){t.editingModel.set("flickrPreview",i.value)}),e("#flickr-image-margin",this.$el).change(function(i,l){t.editingModel.set("imageMargin",l.value),-1==l.value&&e(".display-font",e(this)).text("DF")}),e("#flickr-custom-attributes",this.el).initAttributesPanel(t),e("#flickr-column-box-model",t.$el).initBoxModelPanel(t,"boxModelSettings"),e("#flickr-animations input[name=enabled_custom_animation]",this.el).change(function(i,l){t.editingModel.set("customEnableAnimations",parseInt(e(this).val())),l&&t.editingModel.set("customDataAnimations",JSON.stringify(l.animations))})},setPanelElementsValue:function(){var t=this,i=this.editingModel.toJSON();e("#flickr-enter-link input",this.$el).val(i.flickrID),e("#flickr-custom-id input",this.$el).val(i.customID),e("#flickr-custom-class input",this.$el).val(i.customClass),e("#flickr-stream",t.$el).aweSelect("value",i.flickrStream),e("#flickr-preview",t.$el).aweSelect("value",i.flickrPreview),e("#flickr-number-photo",this.$el).aweSlider("value",i.numberPhoto),e("#flickr-column",this.$el).aweSlider("value",i.numberColum),e("#flickr-image-margin",this.$el).aweSlider("value",i.imageMargin),e("#flickr-column-box-model",this.$el).initBoxModel(i.boxModelSettings),e("#flickr-custom-attributes",this.el).initAttributes(i.customEnableAttributes,i.customDataAttributes),e("#flickr-animations input[name=enabled_custom_animation]",this.el).val(i.customEnableAnimations).trigger("change"),e("#flickr-animations input[name=enabled_custom_animation]",this.el).attr("data-animations",i.customDataAnimations).data("view",this.editingModel.view)},buildPanel:function(){return{title:{type:"markup",markup:'<div class="awe-title"><h2>Flickr</h2></div>'},custom_attributes:{type:"section",enter_link:{type:"text_field",title:"Flickr ID",attributes:{placeholder:""},default_value:"32738276@N08"},title:{type:"markup",markup:'<div class="small-quote"><span>To find your flickrID visit <a href="http://idgettr.com/" target="_blank">idGettr</a></span></div>'},number_photo:{type:"slider",title:"No of Img",values:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],default_value:5,allow_type:!0},column:{type:"slider",title:"Column",values:[1,2,3,4,5,6],default_value:3,allow_type:!0},image_margin:{type:"slider",title:"Image Margin",min_value:-1,max_value:20,default_value:3,allow_type:!0,unit:"px"},stream:{type:"select",title:"Stream",options:{user:"User",group:"Group"},default_value:"group"},preview:{type:"select",title:"Preview",options:{openlightbox:"Lightbox",linktoflickr:"Link to flickr"},default_value:"openlightbox"}},custom_box_model:{type:"section",column_box_model:{type:"tabs",tabs:[{tab_title:"Border",contents:{custom_border:{type:"box_border",min_value:0,max_value:100,default_value:0}}},{tab_title:"Radius",contents:{custom_border_radius:{type:"box_model",model_type:"border_radius",allow_type:!0,min_value:0,max_value:100,default_value:0}}},{tab_title:"Padding",contents:{custom_padding:{type:"box_model",model_type:"padding",allow_type:!0,min_value:0,max_value:100,default_value:0}}},{tab_title:"Margin",contents:{custom_margin:{type:"box_model",model_type:"margin",allow_type:!0,min_value:0,max_value:100,default_value:0}}}]}},custom_definitions:{type:"section",custom_id:{type:"text_field",title:"ID",attributes:{placeholder:"Custom ID"},default_value:""},custom_class:{type:"text_field",title:"CSS class",attributes:{placeholder:"Custom class"},default_value:""},custom_attributes:{type:"custom_attributes"},animations:{type:"animations"}}}}}),e(document).ready(function(){AWEContent.Controllers.flickr=new AWEContent.Views.FlickrItemController,AWEContent.Panels.flickr=new AWEContent.Views.FlickrPanel})}(jQuery);