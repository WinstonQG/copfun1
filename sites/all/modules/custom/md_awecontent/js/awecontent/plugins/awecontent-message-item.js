!function(e){"use strict";AWEContent.Models.MessageItem=AWEContent.Models.Item.extend({defaults:{machine_name:"message",textMessage:"Type your message here",messageType:"alert-success",fontFamily:"",fontStyle:"",textAlign:"left",fontSize:-1,lineHeight:-1,letterSpacing:-1,color:"",backgroundColor:"",boxModelSettings:{},customID:"",customClass:"",customEnableAttributes:0,customDataAttributes:"[] ",customActionAttributes:'{"newAction": "", "newAttrName": "", "newAttrValue": ""}',customEnableAnimations:0,customDataAnimations:'{"type" : "none"}',lgResponsive:!0,xsResponsive:!0,mediumResponsive:!0,smResponsive:!0},relations:[{type:Backbone.HasOne,key:"boxModelSettings",relatedModel:AWEContent.Models.BoxModelSettings}],createView:function(){this.view=new AWEContent.Views.MessageItem({model:this})},clone:function(){var t={};return e.each(this.toJSON(),function(e,s){t[e]=s}),t.boxModelSettings=new AWEContent.Models.BoxModelSettings(t.boxModelSettings),new AWEContent.Models.MessageItem(t)}}),AWEContent.Views.MessageItem=AWEContent.Views.Item.extend({initialize:function(){AWEContent.Views.Item.prototype.initialize.call(this),this.listenTo(this.model.get("boxModelSettings"),"change",this.applySettingsChanged)},renderItemContent:function(){var t=this,s=t.model.toJSON(),n=e('<div class="awe-message awe-item alert"></div>'),a={"font-size":-1==s.fontSize?"":s.fontSize+"px","line-height":-1==s.lineHeight?"":s.lineHeight+"px","letter-spacing":-1==s.letterSpacing?"":s.letterSpacing+"px",color:s.color,"background-color":s.backgroundColor,"font-family":s.fontFamily};return s.fontStyle&&(a=e.extend({},a,JSON.parse(s.fontStyle))),n.addClass(s.messageType).css(a).html(s.textMessage).renderItemDefaultBoxModel(s.boxModelSettings),""!=s.customClass&&n.addClass(s.customClass),s.customID&&n.attr("id",s.customID),n.renderItemDefaultAttributes(s.customEnableAttributes,s.customDataAttributes),s.customEnableAnimations&&n.processAnimations(s.customDataAnimations),t.iframeJQuery(this.el).delegate(".awe-message","itemReady",function(){var s,n;t.iframeJQuery(this).hallo({plugins:{halloformat:{formattings:{bold:!0,italic:!0,underline:!0,strikethrough:!0}},hallojustify:{},hallolists:{lists:{ordered:!0,unordered:!0}}},create:function(){this.addEventListener("paste",function(e){e.preventDefault();var t=e.clipboardData.getData("text/plain");AWEContent.documentIframe.execCommand("insertHTML",!1,t)})},editable:!0,activate:function(t){s=e(t.target).height()},deactivated:function(a){t.changeContent(a),n=e(a.target).height(),n!=s&&t.resizeItem()}})}),t.$el.defaultResponsive(s),n},applySettingsChanged:function(t){var s=this,n=s.model.toJSON(),a=e("> .awe-message",s.el),o=s.$el.height();e.each(t.changedAttributes(),function(e,o){switch(s.$el.changeResponsive(e,o),a.renderChangeSettingBoxModel(e,o,t),e){case"messageType":var i=s.model.previousAttributes().messageType;a.removeClass(i).addClass(o);break;case"fontFamily":a.css("font-family",o);break;case"fontStyle":var l=o?JSON.parse(o):{"font-weight":"","font-style":""};a.css(l);break;case"textAlign":a.css("text-align",o);break;case"fontSize":-1==o?a.css("font-size",""):a.css("font-size",o+"px");break;case"lineHeight":-1==o?a.css("line-height",""):a.css("line-height",o+"px");break;case"letterSpacing":-1==o?a.css("letter-spacing",""):a.css("letter-spacing",o+"px");break;case"color":a.css("color",o);break;case"backgroundColor":a.css("background-color",o);break;case"customID":a.attr("id",o);break;case"customClass":var c=s.model.previousAttributes().customClass;a.removeClass(c).addClass(o);break;case"customEnableAttributes":a.renderChangeSettingsAttributes(e,o,n.customDataAttributes);break;case"customActionAttributes":a.renderChangeSettingsAttributes(e,o);break;case"customEnableAnimations":var r,m;o?(r=n.customDataAnimations,m=null,a.processAnimations(r)):(r=null,m=n.customDataAnimations,a.processAnimations(r,m));break;case"customDataAnimations":var r,m;r=n.customDataAnimations,m=s.model.previousAttributes().customDataAnimations,a.processAnimations(r,m)}}),setTimeout(function(){s.checkChangeHeight(o)},50)},changeContent:function(t){var s=e(t.currentTarget).html();this.model.set("textMessage",s)}}),AWEContent.Views.MessageItemController=AWEContent.Views.ItemController.extend({machineName:"message",controllerHtml:function(){return'<div class="title-icon">Message</div><i class="ic ac-icon-message"></i>'},createItemModel:function(e){var t;return void 0!=e?(t=new AWEContent.Models.BoxModelSettings(e.boxModelSettings),e.boxModelSettings=t,new AWEContent.Models.MessageItem(e)):new AWEContent.Models.MessageItem({boxModelSettings:new AWEContent.Models.BoxModelSettings})}}),AWEContent.Views.MessagePanel=AWEContent.Views.ItemPanel.extend({tagName:"div",className:"awe-obj-panel panel-message",panelName:"message",initPanel:function(){AWEContent.Views.ItemPanel.prototype.initPanel.call(this);var t=this;e("#message-style",this.$el).change(function(e,s){t.editingModel.set("messageType",s.value)}),e("#message-font-name",this.$el).bind("fontFamilyChange",function(e,s){t.editingModel.set("fontFamily",s)}).bind("fontStyleChange",function(e,s){t.editingModel.set("fontStyle",s.value)}).bind("textAlignChange",function(e,s){t.editingModel.set("textAlign",s.value)}).bind("fontSizeChange",function(e,s){t.editingModel.set("fontSize",s.value)}).bind("letterSpacingChange",function(e,s){t.editingModel.set("letterSpacing",s.value)}).bind("lineHeightChange",function(e,s){t.editingModel.set("lineHeight",s.value)}),e("#message-color",this.$el).change(function(e,s){s=s?s.toRgbString():"",t.editingModel.set("color",s)}),e("#message-background-color",this.$el).change(function(e,s){s=s?s.toRgbString():"",t.editingModel.set("backgroundColor",s)}),e("#message-column-box-model",t.el).initBoxModelPanel(t,"boxModelSettings"),e("#text-message-custom-id",t.el).change(function(){t.editingModel.set("customID",e(this).val())}),e("#text-message-custom-class",t.el).change(function(){t.editingModel.set("customClass",e(this).val())}),e("#message-custom-attributes",this.el).initAttributesPanel(t),e("#message-animations input[name=enabled_custom_animation]",this.el).change(function(s,n){t.editingModel.set("customEnableAnimations",parseInt(e(this).val())),n&&t.editingModel.set("customDataAnimations",JSON.stringify(n.animations))})},setPanelElementsValue:function(){var t=this.editingModel.toJSON();e("#message-style",this.$el).aweSelect("value",t.messageType),e("#message-font-name",this.$el).aweFont("options",{fontFamily:t.fontFamily,fontStyle:t.fontStyle,textAlign:t.textAlign,fontSize:t.fontSize,lineHeight:t.lineHeight,letterSpacing:t.letterSpacing}),e("#message-color",this.$el).aweColorPicker("value",t.color),e("#message-background-color",this.$el).aweColorPicker("value",t.backgroundColor),e("#message-column-box-model",this.$el).initBoxModel(t.boxModelSettings),e("#text-message-custom-id",this.$el).val(t.customID),e("#text-message-custom-class",this.$el).val(t.customClass),e("#message-custom-attributes",this.$el).initAttributes(t.customEnableAttributes,t.customDataAttributes),e("#message-animations input[name=enabled_custom_animation]",this.$el).val(t.customEnableAnimations).trigger("change"),e("#message-animations input[name=enabled_custom_animation]",this.$el).attr("data-animations",t.customDataAnimations).data("view",this.editingModel.view)},buildPanel:function(){return{title:{type:"markup",markup:'<div class="awe-title"><h2>Message</h2></div>'},custom_type:{type:"section",style:{type:"select",title:"Type",options:{"alert-success":"Success","alert-info":"Info","alert-warning":"Warning","alert-danger":"Danger"},default_value:"alert-success"}},custom_style:{type:"section",font_name:{type:"font"}},custom_color:{type:"section",color:{type:"colorpicker",title:"Color",options:{preferredFormat:"rgb",AlphaVerticle:!0,showAlpha:!0,allowEmpty:!0,showInput:!0}},background_color:{type:"colorpicker",title:"Background color",options:{preferredFormat:"rgb",AlphaVerticle:!0,showAlpha:!0,allowEmpty:!0,showInput:!0}}},custom_box_model:{type:"section",column_box_model:{type:"tabs",tabs:[{tab_title:"Border",contents:{custom_border:{type:"box_border",min_value:0,max_value:100,default_value:0}}},{tab_title:"Radius",contents:{custom_border_radius:{type:"box_model",model_type:"border_radius",allow_type:!0,min_value:0,max_value:100,default_value:0}}},{tab_title:"Padding",contents:{custom_padding:{type:"box_model",model_type:"padding",allow_type:!0,min_value:0,max_value:100,default_value:0}}},{tab_title:"Margin",contents:{custom_margin:{type:"box_model",model_type:"margin",allow_type:!0,min_value:0,max_value:100,default_value:0}}}]}},custom_definitions:{type:"section",custom_id:{type:"text_field",title:"ID",attributes:{placeholder:"wrapper"},default_value:""},custom_class:{type:"text_field",title:"CSS class",attributes:{placeholder:"wrapper"},default_value:""},custom_attributes:{type:"custom_attributes"},animations:{type:"animations"}}}}}),e(document).ready(function(){AWEContent.Controllers.message=new AWEContent.Views.MessageItemController,AWEContent.Panels.message=new AWEContent.Views.MessagePanel})}(jQuery);