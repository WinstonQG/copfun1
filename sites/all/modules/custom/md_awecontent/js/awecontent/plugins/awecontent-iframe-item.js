!function(t){"use strict";AWEContent.Models.IframeItem=AWEContent.Models.Item.extend({defaults:{machine_name:"iframe",iframeUrl:"http://megadrupal.com/",height:500,boxModelSettings:{},customID:"",customClass:"",customEnableAttributes:0,customDataAttributes:"[] ",customActionAttributes:'{"newAction": "", "newAttrName": "", "newAttrValue": ""}',customEnableAnimations:0,customDataAnimations:'{"type" : "none"}',lgResponsive:!0,xsResponsive:!0,mediumResponsive:!0,smResponsive:!0},relations:[{type:Backbone.HasOne,key:"boxModelSettings",relatedModel:AWEContent.Models.BoxModelSettings}],createView:function(){this.view=new AWEContent.Views.IframeItem({model:this})},clone:function(){var e={};return t.each(this.toJSON(),function(t,i){e[t]=i}),e.boxModelSettings=new AWEContent.Models.BoxModelSettings(e.boxModelSettings),new AWEContent.Models.IframeItem(e)}}),AWEContent.Views.IframeItem=AWEContent.Views.Item.extend({initialize:function(){AWEContent.Views.Item.prototype.initialize.call(this),this.listenTo(this.model.get("boxModelSettings"),"change",this.applySettingsChanged)},renderItemContent:function(){var e=this,i=e.model.toJSON(),a=t('<div class="awe-item-preload"></div><iframe class="awe-item awe-iframe" src="" width="100%"></iframe>');if(a.attr({src:e.processUrl(i.iframeUrl),id:i.customID}).css({height:-1==i.height?"":i.height+"px"}).addClass(i.customClass),a.renderItemDefaultBoxModel(i.boxModelSettings),i.customEnableAttributes&&"[]"!=i.customDataAttributes&&t.each(t.parseJSON(i.customDataAttributes),function(t,e){var i="data-"+e.attrName,n=e.attrValue;a.attr(i,n)}),a.renderItemDefaultAttributes(i.customEnableAttributes,i.customDataAttributes),i.customEnableAnimations){var n=i.customDataAnimations;a.processAnimations(n)}return e.$el.defaultResponsive(i),a.load(function(){t(".awe-item-preload",e.$el).remove()}),a},applySettingsChanged:function(e){var i=this,a=t("> iframe",i.$el),n=e.toJSON(),s=i.$el.height();t.each(e.changedAttributes(),function(t,s){switch(i.$el.changeResponsive(t,s),a.renderChangeSettingBoxModel(t,s,e),t){case"iframeUrl":i.$el.prepend('<div class="awe-item-preload"></div>'),a.attr("src",i.processUrl(s));break;case"height":-1==s?a.css("height",""):a.css("height",s+"px");break;case"customID":a.attr("id",s);break;case"customClass":var o=i.model.previousAttributes().customClass;a.removeClass(o).addClass(s);break;case"customEnableAttributes":a.renderChangeSettingsAttributes(t,s,n.customDataAttributes);break;case"customActionAttributes":a.renderChangeSettingsAttributes(t,s);break;case"customEnableAnimations":var l,m;s?(l=n.customDataAnimations,m=null,a.processAnimations(l)):(l=null,m=n.customDataAnimations,a.processAnimations(l,m));break;case"customDataAnimations":var l,m;l=n.customDataAnimations,m=i.model.previousAttributes().customDataAnimations,a.processAnimations(l,m)}}),setTimeout(function(){i.checkChangeHeight(s)},50)},processUrl:function(t){return""!=t?0==t.indexOf("http://")||0==t.indexOf("//")||0==t.indexOf("https://")?t:"http://"+t:void 0}}),AWEContent.Views.IframeItemController=AWEContent.Views.ItemController.extend({machineName:"iframe",controllerHtml:function(){return'<div class="title-icon">iframe</div><i class="ic ac-icon-iframe"></i>'},createItemModel:function(t){var e;return void 0!=t?(e=new AWEContent.Models.BoxModelSettings(t.boxModelSettings),t.boxModelSettings=e,new AWEContent.Models.IframeItem(t)):new AWEContent.Models.IframeItem({boxModelSettings:new AWEContent.Models.BoxModelSettings})}}),AWEContent.Views.IframePanel=AWEContent.Views.ItemPanel.extend({tagName:"div",className:"awe-obj-panel panel-iframe",panelName:"iframe",initPanel:function(){AWEContent.Views.ItemPanel.prototype.initPanel.call(this);var e=this;t("#text-iframe-enter-link",e.el).change(function(){e.editingModel.set("iframeUrl",t(this).val())}),t("#iframe-height",e.el).change(function(i,a){e.editingModel.set("height",a.value),-1==a.value&&t(".display-font",t(this)).text("DF")}),t("#iframe-column-box-model",e.el).initBoxModelPanel(e,"boxModelSettings"),t("#text-iframe-custom-id",e.el).change(function(){e.editingModel.set("customID",t(this).val())}),t("#text-iframe-custom-class",e.el).change(function(){e.editingModel.set("customClass",t(this).val())}),t("#iframe-custom-attributes",this.el).initAttributesPanel(e),t("#iframe-animations input[name=enabled_custom_animation]",this.el).change(function(i,a){e.editingModel.set("customEnableAnimations",parseInt(t(this).val())),a&&e.editingModel.set("customDataAnimations",JSON.stringify(a.animations))})},setPanelElementsValue:function(){var e=this,i=this.editingModel.toJSON();t("#text-iframe-enter-link",e.el).val(i.iframeUrl),t("#iframe-height",e.el).aweSlider("value",i.height),t("#iframe-column-box-model",e.el).initBoxModel(i.boxModelSettings),t("#text-iframe-custom-id",e.el).val(i.customID),t("#text-iframe-custom-class",e.el).val(i.customClass),t("#iframe-custom-attributes",this.el).initAttributes(i.customEnableAttributes,i.customDataAttributes),t("#iframe-animations input[name=enabled_custom_animation]",this.el).val(i.customEnableAnimations).trigger("change"),t("#iframe-animations input[name=enabled_custom_animation]",this.el).attr("data-animations",i.customDataAnimations).data("view",this.editingModel.view)},buildPanel:function(){return{title:{type:"markup",markup:'<div class="awe-title"><h2>Custom Iframe</h2></div>'},custom_attributes:{type:"section",enter_link:{type:"text_field",title:"Link",attributes:{placeholder:"http://..."},default_value:"http://"},height:{type:"slider",title:"Height",min_value:-1,max_value:999,default_value:300,allow_type:!0,unit:"px"}},custom_box_model:{type:"section",column_box_model:{type:"tabs",tabs:[{tab_title:"Border",contents:{custom_border:{type:"box_border",min_value:0,max_value:100,default_value:0}}},{tab_title:"Radius",contents:{custom_border_radius:{type:"box_model",model_type:"border_radius",allow_type:!0,min_value:0,max_value:100,default_value:0}}},{tab_title:"Padding",contents:{custom_padding:{type:"box_model",model_type:"padding",allow_type:!0,min_value:0,max_value:100,default_value:0}}},{tab_title:"Margin",contents:{custom_margin:{type:"box_model",model_type:"margin",allow_type:!0,min_value:0,max_value:100,default_value:0}}}]}},custom_definitions:{type:"section",custom_id:{type:"text_field",title:"ID",attributes:{placeholder:"Custom ID"},default_value:""},custom_class:{type:"text_field",title:"CSS class",attributes:{placeholder:"Custom class"},default_value:""},custom_attributes:{type:"custom_attributes"},animations:{type:"animations"}}}}}),t(document).ready(function(){AWEContent.Controllers.iframe=new AWEContent.Views.IframeItemController,AWEContent.Panels.iframe=new AWEContent.Views.IframePanel})}(jQuery);